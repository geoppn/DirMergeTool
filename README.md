Εργασία 4 - Λειτουργικά Συστήματα
Γεώργιος Παπαϊωάννου - 1115202100222
Δαμιανός Πούλιας - 1115202100???

Εντολές Make :
make        -> Δημιουργία εκτελέσιμου
make clean  -> Διαγραφή εκτελέσιμου/αντικειμενικών αρχείων
make rdir   -> Διαγραφή default DIR3 (Merged Directory)

Εντολή Εκτέλεσης :
./cmpcat -d DIR1 DIR2 [-s DIR3]

(Ανεξαρτήτου σειράς & ονομάτων των Directories DIR1 DIR2 [DIR3])

Για την επίδειξη της ορθής λειτουργίας του προγράμματος δινόνται τα DIR1 & DIR2 :
Τα οποία καλύπτουν όλες τις περιπτώσεις που ορίζονται από την εκφώνηση.
Πιο συγκεκριμένα : 

....

Υλοποίηση προβλήματος:

Για την εργασία αυτή, αποφασίσαμε να δημιουργήσουμε ένα ζεύγος αρχείων .h και πηγαίου κώδικα που χειρίζονται τις διάφορες συναρτήσεις που χρησιμοποιούνται για την επίτευξη του στόχου μας, μαζί με ένα κύριο αρχείο πηγαίου κώδικα που χειρίζεται σωστά τις εισόδους, τις κλήσεις συναρτήσεων και την αρχικοποίηση της μνήμης. Όπως αναφέρθηκε προηγουμένως, παρέχουμε επίσης το ζητούμενο Makefile και ένα απλό παράδειγμα για να καλύψουμε τις περισσότερες περιπτώσεις διαφορών.

Μέσα στο αρχείο κεφαλίδας μας, περιλαμβάνουμε τις περισσότερες από τις απαιτούμενες βιβλιοθήκες που βοηθούν στην υλοποίηση του έργου μας. Ξεκινώντας, για να αυξήσουμε δραστικά την αναγνωσιμότητα του κώδικά μας, ορίζουμε τις μεταβλητές "EXISTS" και "NOTEXISTS" που χρησιμοποιούνται στις συναρτήσεις μας για να δηλώνουν αν μια καταχώρηση υπάρχει. Χρησιμοποιούμε επίσης ένα enum για να καθορίσουμε τον τύπο κάθε καταχώρησης dirent για μελλοντική χρήση. Στη συνέχεια, δηλώνουμε την κύρια δομή μας που συγκρατεί όλες τις απαραίτητες πληροφορίες για κάθε καταχώρηση, οι οποίες αποτελούνται από: την απόλυτη διαδρομή της για συγκρίσεις και πρόσβαση, τη σχετική διαδρομή της για σκοπούς εκτύπωσης, το όνομά της, το μέγεθός της σε bytes, την ημερομηνία της τελευταίας τροποποίησης εντός της καταχώρησης (για σύγκριση όταν υποδηλώνεται από την εκφώνηση), το id του i-node για συγκρίσεις hard link, έναν δείκτη link για soft links και τον τύπο. Τέλος, δηλώνουμε επικεφαλίδες συναρτήσεων για όλες τις κύριες συναρτήσεις μας και τις βοηθητικές συναρτήσεις που βοηθούν στην ευρύτερη εικόνα.

Για την υλοποίηση των συναρτήσεων, έχουμε:
compare_files() η οποία ανοίγει δύο αρχεία που παρέχονται, ελέγχει την εγκυρότητά τους και στη συνέχεια συγκρίνει τα περιεχόμενά τους χαρακτήρα προς χαρακτήρα (όπως ζητείται στην επικεφαλίδα) και επιστρέφει ένα αποτέλεσμα. Έχουμε επίσης την file_exists() η οποία χρησιμοποιεί την κλήση access() για να δηλώσει αν η απόλυτη διαδρομή προς ένα αρχείο είναι σωστή και το αρχείο υπάρχει, παράλληλα με την directory_exists() η οποία εξυπηρετεί παρόμοιο σκοπό χρησιμοποιώντας την stat(). Τέλος, έχουμε το σετ copy_directory() και copy_file() που δημιουργούν αντίστοιχα ένα άμεσο αντίγραφο των καταλόγων και των αρχείων που παρέχονται. Χρησιμοποιούμε τη βιβλιοθήκη dirent για να επιτύχουμε την αντιγραφή καταλόγων, παράλληλα με μια αναδρομική κλήση αν χρειαστεί για εμφωλευμένους καταλόγους και την copy_file για άλλα αρχεία μέσα σε αυτούς. Όσον αφορά την copy_file, απλά προσπελαύνουμε αρχεία, ελέγχουμε την εγκυρότητά τους και χρησιμοποιούμε τις fputc και fgetc για να δημιουργήσουμε ένα αντίγραφο τους.

Τώρα για τις κύριες συναρτήσεις, έχουμε:

read_directory(), στην οποία δίνεται ένα μονοπάτι και δημιουργεί έναν πίνακα εγγραφών EntryInfo που αργότερα παρέχουμε στις άλλες συναρτήσεις για πιο εντατική εργασία. Στην πρώτη κλήση της συνάρτησης (αφού είναι αναδρομική για εμφωλευμένους καταλόγους), αποθηκεύουμε το αρχικό μήκος του ονόματος του πρώτου καταλόγου, καθώς πρέπει να το αφαιρέσουμε για τη σχετική διαδρομή. Στη συνέχεια, έχουμε τον κύριο βρόχο while που περνάει από όλες τις καταχωρήσεις μέσα στον κατάλογο χρησιμοποιώντας τη dirent. Με τη χρήση της απόλυτης διαδρομής, παίρνουμε τις πληροφορίες του i-κόμβου και στη συνέχεια είμαστε έτοιμοι να αρχειοθετήσουμε την καταχώρηση. Έχουμε επίσης μια συνθήκη που αυξάνει το μέγεθος του δυναμικού μας πίνακα σε περίπτωση που χρειαστεί, για να παρέχει εύρος και να αποτρέψει τη σπατάλη μνήμης. Τώρα, για κάθε καταχώρηση αρχικοποιούμε κάποιες πληροφορίες που είναι αποκλειστικές για έναν μόνο τύπο καταχωρήσεων και χρησιμοποιώντας τις πληροφορίες i-node και κάποιους άλλους απλούς υπολογισμούς, γεμίζουμε τις ανάγκες της δομής για κάθε καταχώρηση. Μόλις ο κατάλογος και όλοι οι υποκατάλογοι του διαβαστούν πλήρως, ο κατάλογος κλείνει και έχουμε το τελικό μας αποτέλεσμα. Οι παράμετροι μας για αυτή τη συνάρτηση περιλαμβάνουν κάποιες επιπλέον πληροφορίες λόγω της ανάγκης για αναδρομής.\

[COMPARE]

[MERGE]


Telos.... [MAIN]


[SLAY]